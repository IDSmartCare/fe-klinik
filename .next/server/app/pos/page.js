(()=>{var e={};e.id=5664,e.ids=[5664],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},22721:e=>{"use strict";e.exports=require("@react-pdf/renderer")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},30460:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(33898),a(44465),a(35866);var r=a(23191),n=a(88716),s=a(37922),i=a.n(s),l=a(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["pos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,33898)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\pos\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,44465)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\pos\\page.tsx"],u="/pos/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/pos/page",pathname:"/pos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},44433:(e,t,a)=>{let r={"0ea77e3981c4e4d56d727c089baed4b65d225843":()=>Promise.resolve().then(a.bind(a,71740)).then(e=>e.default),"4a85e0059880b29bda1328903e2cf70fc7b9c4be":()=>Promise.resolve().then(a.bind(a,45147)).then(e=>e.default)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0ea77e3981c4e4d56d727c089baed4b65d225843":n.bind(null,"0ea77e3981c4e4d56d727c089baed4b65d225843"),"4a85e0059880b29bda1328903e2cf70fc7b9c4be":n.bind(null,"4a85e0059880b29bda1328903e2cf70fc7b9c4be")}},86982:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,12994,23)),Promise.resolve().then(a.t.bind(a,96114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,79671,23)),Promise.resolve().then(a.t.bind(a,41868,23)),Promise.resolve().then(a.t.bind(a,84759,23))},74802:(e,t,a)=>{Promise.resolve().then(a.bind(a,10351))},95850:(e,t,a)=>{Promise.resolve().then(a.bind(a,76983))},33265:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var r=a(43353),n=a.n(r)},90434:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var r=a(79404),n=a.n(r)},35047:(e,t,a)=>{"use strict";var r=a(77389);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},43353:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=a(98052);a(10326),a(17577);let n=r._(a(77028));function s(e,t){var a;let r={loading:e=>{let{error:t,isLoading:a,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let s={...r,...t};return(0,n.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let r=a(94129);function n(e){let{reason:t,children:a}=e;throw new r.BailoutToCSRError(t)}},77028:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=a(10326),n=a(17577),s=a(933),i=a(46618);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,n.lazy)(()=>t.loader().then(l)),d=t.loading;function c(e){let l=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.PreloadCss,{moduleIds:t.modules}),(0,r.jsx)(a,{...e})]}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(n.Suspense,{fallback:l,children:o})}return c.displayName="LoadableComponent",c}},46618:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return s}});let r=a(10326),n=a(55403);function s(e){let{moduleIds:t}=e,a=(0,n.getExpectedRequestStore)("next/dynamic css"),s=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));s.push(...t)}}return 0===s.length?null:(0,r.jsx)(r.Fragment,{children:s.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},42651:(e,t,a)=>{"use strict";a.d(t,{c:()=>r});let r=e=>{let t=e.trim().split(" ");return 1===t.length?{firstName:t[0],lastName:t[0]}:{firstName:t[0],lastName:t.slice(1).join(" ")}}},32859:(e,t,a)=>{"use strict";a.d(t,{o:()=>n});var r=a(12919);function n({icon:e,title:t}){r.Z.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=r.Z.stopTimer,e.onmouseleave=r.Z.resumeTimer}}).fire({icon:e,title:t})}},28472:(e,t,a)=>{"use strict";a.d(t,{V:()=>n,b:()=>r});let r=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0,minimumFractionDigits:0}).format(Number(e)),n=e=>{let t=Number(e.replace(/[^0-9]/g,""));return isNaN(t)?"":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}},10351:(e,t,a)=>{"use strict";a.d(t,{NextAuthProvider:()=>s});var r=a(10326),n=a(77109);let s=({children:e})=>r.jsx(n.SessionProvider,{children:e})},66802:(e,t,a)=>{"use strict";a.d(t,{P:()=>r,n:()=>n});let r=async({url:e})=>{try{let t=await fetch(`http://localhost:8001/api/${e}`,{headers:{"Content-Type":"application/json",Authorization:"IDsM4RtcaR32024*@>"}});if(!t.ok)return console.error(`Error: ${t.status} - ${t.statusText}`),null;return await t.json()}catch(e){return console.error("Failed to fetch data:",e),null}},n=async({url:e,data:t})=>{try{let a=await fetch(`http://localhost:8001/api/${e}`,{headers:{"Content-Type":"application/json",Authorization:"IDsM4RtcaR32024*@>"},method:"POST",body:JSON.stringify(t)});return await a.json()}catch(e){return null}}},76983:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(10326),n=a(17577),s=a(66802),i=a(77109),l=a(32859);a(15424);var o=a(46242);let d=(0,o.$)("0ea77e3981c4e4d56d727c089baed4b65d225843");var c=a(90434);let u=(0,o.$)("4a85e0059880b29bda1328903e2cf70fc7b9c4be");var m=a(22721),x=a(33265),p=a(3474);let h=(0,x.default)(async()=>{},{loadableGenerated:{modules:["app\\pos\\pageclient\\ModalPrintBill.tsx -> @react-pdf/renderer"]},ssr:!1,loading:()=>r.jsx("p",{children:"Loading..."})}),b=m.StyleSheet.create({page:{padding:30},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},companyInfo:{width:"40%"},customerInfo:{textAlign:"right",width:"60%"},logo:{width:100,height:100},title:{fontSize:24,marginBottom:10,textAlign:"center"},item:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#ddd",marginBottom:5,paddingBottom:5},itemName:{width:"70%"},diskonItem:{width:"40%",textAlign:"center"},qty:{width:"30%",textAlign:"center"},itemPrice:{textAlign:"right",width:"60%"},total:{fontSize:18,marginTop:20,textAlign:"right"}}),g=({data:e})=>r.jsx("div",{children:r.jsx("dialog",{id:"modal-pos-print",className:"modal",children:(0,r.jsxs)("div",{className:"modal-box w-8/12 max-w-2xl",children:[r.jsx("form",{method:"dialog",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"✕"})}),r.jsx(h,{className:"w-full h-80",children:r.jsx(m.Document,{children:(0,r.jsxs)(m.Page,{style:b.page,children:[r.jsx(m.View,{style:b.header,children:(0,r.jsxs)(m.View,{style:b.companyInfo,children:[(0,r.jsxs)(m.Text,{children:["Billing No : ",e?.groupTransaksiId]}),(0,r.jsxs)(m.Text,{children:["Tanggal :"," ",e?.groupTransaksiId&&(0,p.WU)(new Date(e?.createdAt),"dd/MM/yyyy")]}),(0,r.jsxs)(m.Text,{children:["Nama : ",e?.namaPelanggan]}),(0,r.jsxs)(m.Text,{children:["No HP : ",e?.hpPelanggan]})]})}),r.jsx(m.Text,{style:b.title,children:"Billing Obat"}),(0,r.jsxs)(m.View,{style:b.item,children:[r.jsx(m.Text,{style:b.itemName,children:"Item"}),r.jsx(m.Text,{style:b.diskonItem,children:"Diskon Item"}),r.jsx(m.Text,{style:b.qty,children:"Qty"}),r.jsx(m.Text,{style:b.itemPrice,children:"Sub Total"})]}),e?.transaksiPosDetail.map(e=>r.jsxs(m.View,{style:b.item,children:[r.jsxs(m.Text,{style:b.itemName,children:[e.namaBarang," ",e.hargaJual]}),r.jsxs(m.Text,{style:b.diskonItem,children:[e.diskonFromBo," "]}),r.jsxs(m.Text,{style:b.qty,children:["@",e.qty," "]}),r.jsx(m.Text,{style:b.itemPrice,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.hargaSetelahDiskon)*Number(e.qty))})]},e.id)),(0,r.jsxs)(m.Text,{style:b.total,children:["Sub Total:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e?.subTotal))]}),(0,r.jsxs)(m.Text,{style:b.total,children:["Pajak:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e?.pajak))]}),(0,r.jsxs)(m.Text,{style:b.total,children:["Diskon:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e?.diskonInvoice))]}),(0,r.jsxs)(m.Text,{style:b.total,children:["Biaya Lain:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e?.biayaLainnya))]}),(0,r.jsxs)(m.Text,{style:b.total,children:["Total:"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e?.total))]})]})})})]})})});var f=a(28472),y=a(46226),j=a(35047),N=a(14947),v=a(42651);let w=()=>{let{data:e}=(0,i.useSession)(),[t,a]=(0,n.useState)([]),[o,m]=(0,n.useState)([]),[x,p]=(0,n.useState)(0),[h,b]=(0,n.useState)(0),[w,k]=(0,n.useState)(""),[_,P]=(0,n.useState)(""),[S,I]=(0,n.useState)(""),[T,D]=(0,n.useState)(0),[B,C]=(0,n.useState)(0),[R,A]=(0,n.useState)(0),[E,O]=(0,n.useState)(""),[q,F]=(0,n.useState)(""),[M,L]=(0,n.useState)(""),[$,V]=(0,n.useState)(""),[H,Z]=(0,n.useState)(""),[z,G]=(0,n.useState)(""),[K,W]=(0,n.useState)(""),[Q,J]=(0,n.useState)(K),[U,Y]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(),[et,ea]=(0,n.useState)(null),er={0:"QRIS",1:"Virtual Account",2:"Debit",3:"Cash"},en=(0,n.useRef)(null),[es,ei]=(0,n.useState)(!1),[el,eo]=(0,n.useState)(""),ed=(0,j.useRouter)(),ec=async t=>{let r=e?.user.wfid;if(!r)return;let n=await (0,s.P)({url:`master-barang?wfid=${r}&search=${t}`});a(n?.data?.data)};(0,n.useEffect)(()=>{e?.user?.wfid&&ec(K)},[e?.user,Q,K]),(0,n.useEffect)(()=>{let t=e=>{e.data?.success===!0&&ei(!0)};return window.addEventListener("message",t),(async()=>{if(!es)return;let t=document.getElementById("modal-payment");t?.close();try{if((await d(o,{namaPelanggan:$,emailPelanggan:""===q.trim()?"noemail@gmail.com":q,groupTransaksiId:el,hpPelanggan:M,diskonInvoice:B.toString(),pajak:R.toString(),biayaLainnya:w??"0",kategoriBayar:er[et??3],subTotal:x.toString(),total:h.toString(),totalBayar:E},e?.user?.idFasyankes,e?.user?.package)).status){let t={barang:o.map(e=>({barang_id:e.barang_id,nama_obat:e.nama_barang,qty:e.qty})),wfid:e?.user?.wfid},a=await (0,s.n)({url:"decrease-stock",data:t});if(!a.status){(0,l.o)({icon:"error",title:a.message});return}await ec(K),(0,l.o)({icon:"success",title:"Berhasil"}),m([]),em([]),k(""),F(""),L(""),V(""),eo(""),ea(null),ei(!1),ed.refresh();let r=await u(el);ee(r.data),setTimeout(()=>{let e=document?.getElementById("modal-pos-print");e?.show()},2e3)}}catch(e){console.error(e),(0,l.o)({icon:"error",title:"An error occurred"})}})(),()=>{window.removeEventListener("message",t)}},[es]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{J(K)},500);return()=>{clearTimeout(e)}},[K]);let eu=e=>{if(o.find(t=>t.barang_id===e.barang_id)){let t=o.map(t=>{if(t.barang_id===e.barang_id){let a=0;if(e.diskon?.percent_disc){let t=Number(e.barang.harga_jual)*(Number(e.diskon.percent_disc)/100);a=Number(e.barang.harga_jual)-t}else a=Number(e.barang.harga_jual)-Number(e.diskon?.amount_disc)?Number(e.barang.harga_jual)-Number(e.diskon?.amount_disc):Number(e.barang.harga_jual);return{...t,qty:t.qty+1,totalHarga:Number(t.qty+1)*a}}return t});m(t),em(t)}else{let t=0;if(e.diskon?.percent_disc){let a=Number(e.barang.harga_jual)*(Number(e.diskon.percent_disc)/100);t=Number(e.barang.harga_jual)-a}else t=Number(e.barang.harga_jual)-Number(e.diskon?.amount_disc)?Number(e.barang.harga_jual)-Number(e.diskon?.amount_disc):Number(e.barang.harga_jual);let a={barang_id:e.barang_id,nama_barang:e.barang.nama_barang,harga_jual:e.barang.harga_jual,qty:1,totalHarga:t,diskonFromBo:e.diskon?.amount_disc?e.diskon.amount_disc:e.diskon?.percent_disc?Number(e.barang.harga_jual)*(Number(e.diskon.percent_disc)/100):0},r=[...o,a];m([...o,a]),em(r)}},em=e=>{let t=e.reduce((e,t)=>e+t.totalHarga,0);p(t),b(t)},ex=e=>{let t=e.replace(/[^0-9]/g,"");t?(k(t),eg(Number(_),Number(t),Number(S))):(k(""),eg(Number(_),0,Number(S)))},ep=e=>{/^\d*$/.test(e)?(P(e),eg(Number(e),Number(w),Number(S))):(P(""),eg(0,Number(w),Number(S)))},eh=e=>{let t=e.replace(/[^\d]/g,"");"rp"===H?(I((0,f.V)(t)),eg(Number(_),Number(w),Number(t))):"percent"===H&&t.length<=2&&(I(t),eg(Number(_),Number(w),Number(t)))},eb=e=>{Z(e),I(""),en.current&&(en.current.value=""),eg(Number(_),Number(w),0)},eg=(e,t,a)=>{let r=0,n=x,s=e/100*n;A(s),n=x+s,"percent"===H?C(r=a/100*n):(r=a,C(a)),b(n-r+Number(t))},ef=async()=>{if(null==et){(0,l.o)({icon:"error",title:"Silahkan pilih metode pembayaran!"});return}for(let e of[{value:$,message:"Silahkan isi nama pelanggan!"},{value:M,message:"Silahkan isi no hp pelanggan!"}])if(!e.value){(0,l.o)({icon:"error",title:e.message});return}if(""!==q.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(q)){(0,l.o)({icon:"error",title:"Email tidak valid!"});return}if(M.length<13||M.length>15)return(0,l.o)({icon:"error",title:"Nomor HP tidak valid!"}),!1;if(2===et||3===et){let e=document?.getElementById("modal-pos");e?.showModal()}else if(0===et||1===et){let{firstName:e,lastName:t}=(0,v.c)($);try{let a=new Date().valueOf().toString(),r={orderId:a,email:""===q.trim()?"noemail@gmail.com":q,firstName:e,lastName:t,mobilePhone:M.replace(/^0/,"+62"),amount:h,description:"Bayar Obat"},n=await fetch("/api/payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){(0,l.o)({icon:"error",title:"Payment failed"});return}let s=await n.json();G(s.response.redirecturl);let i=document?.getElementById("modal-payment");i?.showModal(),eo(a)}catch(e){console.error(e),(0,l.o)({icon:"error",title:"An error occurred"})}}O(""),D(0)},ey=async t=>{t.preventDefault();let a=new Date().valueOf().toString(),r={barang:o?.map(e=>({barang_id:e.barang_id,nama_obat:e.nama_barang,qty:e.qty})),wfid:e?.user.wfid};if(Number(E)<h){(0,l.o)({icon:"error",title:"Pembayaran tidak boleh kurang"});return}let n=await d(o,{namaPelanggan:$,emailPelanggan:q,groupTransaksiId:a,hpPelanggan:M,diskonInvoice:B.toString(),pajak:R.toString(),biayaLainnya:w??"0",kategoriBayar:er[et??3],subTotal:x.toString(),total:h.toString(),totalBayar:E},e?.user.idFasyankes,e?.user.package);if(n.status){let e=await (0,s.n)({url:"decrease-stock",data:r});if(!e.status){(0,l.o)({icon:"error",title:e.message});return}(0,l.o)({icon:"success",title:n.message}),ed.refresh(),(document?.getElementById("modal-pos")).close(),m([]),em([]),k(""),F(""),L(""),V(""),ea(null),await ec(K),ee((await u(a)).data),setTimeout(()=>{let e=document?.getElementById("modal-pos-print");e?.show()},2e3)}else(0,l.o)({icon:"error",title:n.message})},ej=e=>{let t=o.filter(t=>t.barang_id!==e);em(t),m(t)};return(0,r.jsxs)("div",{className:"flex gap-2 flex-col p-2",children:[r.jsx(c.default,{href:"/klinik",children:(0,r.jsxs)("button",{className:"btn btn-sm btn-primary",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{fillRule:"evenodd",d:"M12.5 9.75A2.75 2.75 0 0 0 9.75 7H4.56l2.22 2.22a.75.75 0 1 1-1.06 1.06l-3.5-3.5a.75.75 0 0 1 0-1.06l3.5-3.5a.75.75 0 0 1 1.06 1.06L4.56 5.5h5.19a4.25 4.25 0 0 1 0 8.5h-1a.75.75 0 0 1 0-1.5h1a2.75 2.75 0 0 0 2.75-2.75Z",clipRule:"evenodd"})}),"Kembali"]})}),(0,r.jsxs)("div",{role:"alert",className:"alert alert-info",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"h-6 w-6 shrink-0 stroke-current",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{children:"POS Penjualan Obat"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("div",{className:"w-2/3 h-full flex flex-col min-h-screen p-2",children:[r.jsx("input",{type:"text",placeholder:"Cari obat",className:"input input-primary w-full join-item",value:K,onChange:e=>{W(e.target.value)}}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"table",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Produk"}),r.jsx("th",{children:"Harga"}),r.jsx("td",{children:"Diskon"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:t?.map(e=>{let t=o.find(t=>t.barang_id===e.barang_id),a=!!t&&t.qty>=e.stok;return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-bold",children:e?.barang?.nama_barang||"Unknown Name"}),r.jsxs("div",{className:"text-sm opacity-50",children:["Stok: ",e?.stok??"N/A"]})]})})}),r.jsx("td",{children:e?.barang?.harga_jual?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.barang.harga_jual)):"Unknown Price"}),r.jsx("td",{children:e?.diskon?"Percentage"===e.diskon.type?`${e.diskon.percent_disc}%`:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.diskon.amount_disc)):"No Discount"}),r.jsx("th",{children:r.jsx("button",{onClick:()=>eu(e),className:"btn btn-primary",disabled:a||e?.stok===0,children:"Tambah"})})]},e?.barang_id)})})]})})]}),r.jsx("div",{className:"w-1/3",children:(0,r.jsxs)("div",{className:"flex flex-col bg-base-200 min-h-screen p-2 gap-2",children:[r.jsx("p",{className:"text-xl font-medium",children:"Biodata Pasien"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"font-medium label-text",children:["Nama ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:$,onChange:e=>V(e.target.value),className:"input input-bordered w-full max-w-xs"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"font-medium label-text",children:["No HP ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:M,onChange:e=>{let t=e.target.value;if(""===t){L(t);return}t.startsWith("0")?t="+62"+t.slice(1):!t.startsWith("+62")&&t.length>0&&(t="+62"),t.length>14||(t.startsWith("+620")&&(t=t.slice(0,3)),L(t))},placeholder:"+628xxxxxxxxx",className:"input input-bordered w-full max-w-xs"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"font-medium label-text",children:["Email ",r.jsx("span",{className:"text-primary",children:"(Opsional)"})]}),r.jsx("input",{type:"email",value:q,onChange:e=>F(e.target.value),className:"input input-bordered w-full max-w-xs"})]}),r.jsx("div",{className:"divider"}),(0,r.jsxs)("table",{className:"table",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Produk"}),r.jsx("th",{children:"QTY"}),r.jsx("th",{children:"Total"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:o?.map(e=>r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("div",{children:r.jsx("div",{className:"font-bold",children:e.nama_barang})})}),r.jsx("td",{children:e.qty}),r.jsx("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.totalHarga))}),r.jsx("td",{children:r.jsx("button",{className:"btn btn-circle btn-error",onClick:()=>ej(e.barang_id),children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{fillRule:"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z",clipRule:"evenodd"})})})})]},e.barang_id))})]}),r.jsx("div",{className:"divider"}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[r.jsx("p",{className:"text-xl font-medium",children:"Rincian Pembayaran"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium label-text",children:"Sub Total"}),r.jsx("input",{type:"text",value:(0,f.b)(x),readOnly:!0,className:"input input-bordered w-full max-w-xs"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium label-text",children:"Pajak %"}),r.jsx("input",{type:"text",maxLength:2,value:_,onChange:e=>ep(e.target.value),className:"input input-bordered w-full max-w-xs"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium label-text",children:"Diskon"}),r.jsx("p",{children:"%"}),r.jsx("input",{type:"radio",className:"radio radio-primary",onChange:()=>eb("percent"),name:"diskon",value:"percent"}),r.jsx("p",{children:"Rp."}),r.jsx("input",{type:"radio",className:"radio radio-primary",onChange:()=>eb("rp"),name:"diskon",value:"rp"}),r.jsx("input",{ref:en,type:"text",value:"percent"===H?S:(0,f.V)(S),onFocus:()=>Y(!0),onBlur:()=>Y(!1),maxLength:"percent"===H?2:void 0,onChange:e=>eh(e.target.value),className:"input input-bordered w-full max-w-xs"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium label-text",children:"Biaya Lainnya"}),r.jsx("input",{type:"text",value:(0,f.V)(w),onFocus:()=>Y(!0),onBlur:()=>Y(!1),onChange:e=>ex(e.target.value),className:"input input-bordered w-full max-w-xs"})]}),r.jsx("div",{className:"divider"}),e?.user.role!=="admin"&&e?.user.role!=="tester"&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("p",{className:"text-xl font-medium",children:"Metode Pembayaran"}),r.jsx("div",{className:"flex justify-center gap-2",children:[{name:"QRIS",icon:"/QR.png"},{name:"Virtual Account",icon:"/bank.png"},{name:"Debit Card",icon:"/debit.png"},{name:"Cash",icon:"/cash.png"}].map((e,t)=>{let a=et===t;return(0,r.jsxs)("div",{onClick:()=>ea(t),className:`flex flex-col items-center justify-center w-40 h-32
                      } border-2 rounded-lg transition-all duration-300 px-2 ${a?"bg-primary border-primary text-white":"bg-gray-100 border-primary text-black"} hover:shadow-lg hover:scale-105 cursor-pointer`,children:[r.jsx(y.default,{src:e.icon,alt:e.name,width:100,height:80,className:`${"QRIS"===e.name?"w-16 h-8":"w-[48px] h-10"} mb-3 ${a?"filter invert":""}`}),r.jsx("span",{className:`text-sm text-center ${a?"text-white":"text-black"}`,children:e.name})]},t)})}),r.jsx("div",{className:"mt-5",children:(0,r.jsxs)("button",{onClick:()=>ef(),disabled:0===h,className:"btn btn-info btn-block",children:["BAYAR"," ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(h))]})})]})]})]})})]}),r.jsx("dialog",{id:"modal-pos",className:"modal",children:(0,r.jsxs)("div",{className:"modal-box w-4/12 max-w-2xl",children:[r.jsx("form",{method:"dialog",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"✕"})}),(0,r.jsxs)("form",{className:"flex flex-col gap-2",onSubmit:ey,children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-1/3",children:"Total"}),r.jsx("input",{type:"text",readOnly:!0,value:(0,f.b)(h),className:"input input-primary"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-1/3",children:"Bayar"}),r.jsx("input",{type:"text",required:!0,value:(0,f.V)(E),name:"bayar",onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,"");O(t),D(Number(t)-h)},autoFocus:!0,className:"input input-primary"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-1/3",children:"Kembali"}),r.jsx("input",{type:"text",value:(0,f.b)(T),readOnly:!0,className:"input input-primary"})]}),e?.user.role!=="admin"&&e?.user.role!=="tester"&&r.jsx("button",{type:"submit",className:"btn btn-info",children:"BAYAR"})]})]})}),r.jsx(g,{data:X}),r.jsx(N.Z,{src:z})]})}},14947:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(10326),n=a(17577),s=a(12919);let i=({src:e})=>{let[t,a]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{document.getElementById("modal-payment");let e=e=>{"Escape"===e.key&&e.preventDefault()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),r.jsx("dialog",{id:"modal-payment",className:"modal z-0",children:(0,r.jsxs)("div",{className:"modal-box p-10",children:[r.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick:()=>{t||(a(!0),s.Z.fire({title:"Batalkan Pembayaran?",target:document.getElementById("modal-payment"),icon:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Tidak",confirmButtonText:"Ya"}).then(e=>{if(e.isConfirmed){let e=document.getElementById("modal-payment");e?.close()}a(!1)}))},children:"✕"}),r.jsx("div",{className:"w-full",children:r.jsx("iframe",{src:e,style:{height:"600px"},width:"100%"})})]})})}},44465:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m,metadata:()=>u});var r=a(19510),n=a(25384),s=a.n(n);a(5023);var i=a(68570);let l=(0,i.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\layout\AuthLayout.tsx`),{__esModule:o,$$typeof:d}=l;l.default;let c=(0,i.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\layout\AuthLayout.tsx#NextAuthProvider`),u={title:"CoreApp - idSmartCare",description:"CoreApp - idSmartCare"};function m({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:s().className,"data-theme":"light",children:r.jsx(c,{children:e})})})}},71740:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(27745);a(26461);var n=a(20439),s=a(30207);async function i(e,t,a,r){try{if("FREE"===r&&await n.default.transaksiPOS.count({where:{idFasyankes:a}})>=10)return{status:!1,message:"Transaksi untuk paket FREE sudah mencapai batas.",data:null};let i=await n.default.$transaction(async r=>{let n=await r.transaksiPOS.create({data:{groupTransaksiId:t?.groupTransaksiId,biayaLainnya:t?.biayaLainnya,diskonInvoice:t?.diskonInvoice,emailPelanggan:t?.emailPelanggan,hpPelanggan:t?.hpPelanggan,namaPelanggan:t?.namaPelanggan,kategoriBayar:t?.kategoriBayar,pajak:t?.pajak,subTotal:t?.subTotal,total:t?.total,totalBayar:t?.totalBayar,idFasyankes:a}}),s=e.map(e=>({barangId:e.barang_id,namaBarang:e.nama_barang,hargaJual:e.harga_jual,diskonFromBo:e.diskonFromBo.toString(),hargaSetelahDiskon:(Number(e.harga_jual)-Number(e.diskonFromBo)).toString(),qty:e.qty,transaksiPOSId:n.groupTransaksiId}));return await r.transaksiPOSDetail.createMany({data:s}),n});return(0,s.revalidatePath)("/pos"),{status:!0,message:"Berhasil",data:i}}catch(e){return{status:!1,message:e,data:null}}}(0,a(85723).ensureServerEntryExports)([i]),(0,r.registerServerReference)("0ea77e3981c4e4d56d727c089baed4b65d225843",i)},45147:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(27745);a(26461);var n=a(20439);async function s(e){try{let t=await n.default.transaksiPOS.findFirst({where:{groupTransaksiId:e},include:{transaksiPosDetail:!0}});return{status:!0,message:"Berhasil",data:t}}catch(e){return{status:!1,message:e,data:"null"}}}(0,a(85723).ensureServerEntryExports)([s]),(0,r.registerServerReference)("4a85e0059880b29bda1328903e2cf70fc7b9c4be",s)},33898:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>s,default:()=>l});var r=a(68570);let n=(0,r.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\pos\page.tsx`),{__esModule:s,$$typeof:i}=n;n.default;let l=(0,r.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\pos\page.tsx#default`)},20439:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(53524);let n=globalThis.prismaGlobal??new r.PrismaClient},73881:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var r=a(66621);let n=e=>[{type:"image/x-icon",sizes:"32x29",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5819,6621,2481,9404,7787,3474,362,207],()=>a(30460));module.exports=r})();