(()=>{var e={};e.id=5671,e.ids=[5671],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},22721:e=>{"use strict";e.exports=require("@react-pdf/renderer")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},78849:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>d}),a(60248),a(28268),a(44465),a(35866);var r=a(23191),s=a(88716),i=a(37922),n=a.n(i),l=a(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["klinik",{children:["farmasi",{children:["resep",{children:["[...id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,60248)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\CMS LOCAL TEST\\fe-klinik\\src\\app\\klinik\\farmasi\\resep\\[...id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,28268)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\CMS LOCAL TEST\\fe-klinik\\src\\app\\klinik\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,44465)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\CMS LOCAL TEST\\fe-klinik\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\CMS LOCAL TEST\\fe-klinik\\src\\app\\klinik\\farmasi\\resep\\[...id]\\page.tsx"],c="/klinik/farmasi/resep/[...id]/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/klinik/farmasi/resep/[...id]/page",pathname:"/klinik/farmasi/resep/[...id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},21541:(e,t,a)=>{let r={"2c649e101c1182e70ea6174575fc5fe9faab832b":()=>Promise.resolve().then(a.bind(a,86929)).then(e=>e.getTransaksiFarmasi)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"2c649e101c1182e70ea6174575fc5fe9faab832b":s.bind(null,"2c649e101c1182e70ea6174575fc5fe9faab832b")}},28608:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,79404,23)),Promise.resolve().then(a.bind(a,31262))},33265:(e,t,a)=>{"use strict";a.d(t,{default:()=>s.a});var r=a(43353),s=a.n(r)},43353:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let r=a(98052);a(10326),a(17577);let s=r._(a(77028));function i(e,t){var a;let r={loading:e=>{let{error:t,isLoading:a,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let i={...r,...t};return(0,s.default)({...i,modules:null==(a=i.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let r=a(94129);function s(e){let{reason:t,children:a}=e;throw new r.BailoutToCSRError(t)}},77028:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=a(10326),s=a(17577),i=a(933),n=a(46618);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,s.lazy)(()=>t.loader().then(l)),d=t.loading;function u(e){let l=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.PreloadCss,{moduleIds:t.modules}),(0,r.jsx)(a,{...e})]}):(0,r.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(s.Suspense,{fallback:l,children:o})}return u.displayName="LoadableComponent",u}},46618:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let r=a(10326),s=a(55403);function i(e){let{moduleIds:t}=e,a=(0,s.getExpectedRequestStore)("next/dynamic css"),i=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},31262:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var r=a(10326),s=a(17577),i=a(62379),n=a(66802),l=a(32859);a(15424);var o=(0,a(46242).$)("2c649e101c1182e70ea6174575fc5fe9faab832b"),d=a(22721);let u=(0,a(33265).default)(async()=>{},{loadableGenerated:{modules:["app\\klinik\\farmasi\\pageclient\\ModalPrintBillFarmasi.tsx -> @react-pdf/renderer"]},ssr:!1,loading:()=>r.jsx("p",{children:"Loading..."})}),c=({billFarmasi:e,pasien:t})=>{let a=e?.data.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0),s=d.StyleSheet.create({page:{padding:30},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},companyInfo:{width:"40%"},customerInfo:{textAlign:"right",width:"60%"},logo:{width:100,height:100},title:{fontSize:24,marginBottom:10,textAlign:"center"},item:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#ddd",marginBottom:5,paddingBottom:5},itemName:{width:"70%"},itemPrice:{textAlign:"right",width:"30%"},total:{fontSize:18,marginTop:20}});return r.jsx("dialog",{id:"modal-print-bill-farmasi",className:"modal",children:(0,r.jsxs)("div",{className:"modal-box w-8/12 max-w-2xl",children:[r.jsx("form",{method:"dialog",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"âœ•"})}),r.jsx(u,{className:"w-full h-80",children:r.jsx(d.Document,{children:(0,r.jsxs)(d.Page,{style:s.page,children:[r.jsx(d.Text,{style:s.title,children:"Invoice Obat"}),(0,r.jsxs)(d.View,{style:s.item,children:[r.jsx(d.Text,{style:s.itemName,children:"Item"}),r.jsx(d.Text,{style:s.itemPrice,children:"Sub Total"})]}),e?.data.billPasienDetail.map(e=>r.jsxs(d.View,{style:s.item,children:[r.jsxs(d.Text,{style:s.itemName,children:[e.deskripsi," ",e.jumlah,"@",e.harga]}),r.jsx(d.Text,{style:s.itemPrice,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.subTotal))})]},e.id)),(0,r.jsxs)(d.Text,{style:s.total,children:["Total: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(a))]})]})})})]})})};var m=a(35047),p=a(12919);let h=({data:e,session:t,soap:a,pendaftaranId:d,pasien:u})=>{let[h,x]=(0,s.useState)(null),[f,b]=(0,s.useState)({}),[g,j]=(0,s.useState)(!1),[y,k]=(0,s.useState)(!1),[w,v]=(0,s.useState)(),[N,S]=(0,s.useState)(!1),C=(0,s.useId)(),P=(0,m.useRouter)();(0,s.useEffect)(()=>{N?x([]):x(e??[])},[e,N]);let T=async e=>e.length>=2?(await (0,n.P)({url:`master-barang?wfid=${t?.user.wfid}&search=${e}`})).data.data.map(e=>({value:e.barang_id,label:`${e.barang.nama_barang} (${e.barang.satuan})`,satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})):(await (0,n.P)({url:`master-barang?wfid=${t?.user.wfid}`})).data.data.map(e=>({value:e.barang_id,label:`${e.barang.nama_barang} (${e.barang.satuan})`,satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})),_=e=>{e?(b({namaObat:e.label,obatId:e.value,satuan:e.satuan,harga_jual:e.harga_jual,stok:e.stok}),k(!0)):k(!1)},A=()=>{let e={id:Math.random(),namaObat:f.namaObat,obatId:f.obatId,satuan:f.satuan,jumlah:0,signa1:"",signa2:"",aturanPakai:"",waktu:"",catatan:"",hargaJual:f.harga_jual,sOAPId:Number(a.id),createdAt:new Date,updatedAt:new Date,stok:f.stok};h?x([...h,e]):x([e])},O=e=>{h?x([...h.filter(t=>t.id!==e)]):x([])},I=async()=>{if(j(!g),h?.some(e=>0===Number(e.jumlah))){(0,l.o)({icon:"error",title:"Barang tidak boleh berjumlah 0!"});return}let e=h?.map(e=>({...e,total:Number(e.hargaJual)*Number(e.jumlah),pendaftaranId:d})),r={barang:h?.map(e=>({barang_id:e.obatId,nama_obat:e.namaObat,qty:e.jumlah})),wfid:t?.user.wfid};if((await p.Z.fire({title:"Yakin?",text:"Apakah anda yakin ingin menyimpan transaksi ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Iya",cancelButtonText:"Tidak"})).isConfirmed)try{let t=await (0,n.n)({url:"decrease-stock",data:r});if(!t.status){(0,l.o)({icon:"error",title:t.message?t.message:"Silahkan pilih obat terlebih dahulu"});return}if(!(await fetch(`/api/resep/add?idsoap=${a.id}&idpendaftaran=${d}`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).ok){(0,l.o)({icon:"error",title:"Gagal simpan data!"});return}(0,l.o)({icon:"success",title:"Berhasil!"}),P.refresh(),S(!0)}catch(e){console.log(e),(0,l.o)({icon:"error",title:"string"==typeof e.message?e.message:"Terjadi kesalahan!"})}},B=(e,t,a)=>{if(e&&h){let r=h?.findIndex(e=>e.id===a);"jumlah"===t?h[r].jumlah=Number(e):"signa1"===t?h[r].signa1=e:"signa2"===t?h[r].signa2=e:"aturanPakai"===t?h[r].aturanPakai=e:"waktu"===t?h[r].waktu=e:h[r].catatan=e}},q=async()=>{let e=await o(d);e.status?((0,l.o)({icon:"success",title:"Berhasil!"}),v(e),await new Promise(e=>setTimeout(e,2e3)),(document?.getElementById("modal-print-bill-farmasi")).showModal()):(0,l.o)({icon:"error",title:"Gagal ambil data!"})};return(0,r.jsxs)("div",{className:"flex flex-col",children:[!a.isBillingFarmasi&&(0,r.jsxs)("div",{children:[t?.user.role!=="admin"&&(0,r.jsxs)("table",{className:"table table-sm table-zebra mb-8",children:[r.jsx("thead",{className:"bg-base-200",children:r.jsx("tr",{children:r.jsx("th",{colSpan:2,children:"Tambah Obat Baru"})})}),r.jsx("tbody",{children:r.jsx("tr",{className:"bg-info",children:r.jsx("td",{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(i.Z,{className:"select-info w-full",required:!0,isClearable:!0,name:"obat",loadOptions:e=>new Promise(t=>{setTimeout(()=>{t(T(e))},1e3)}),defaultOptions:!0,onChange:e=>_(e),placeholder:"Cari obat",instanceId:C}),t?.user.role!=="tester"&&t?.user.role!=="admin"&&r.jsx("div",{className:"tooltip tooltip-left w-20","data-tip":"Tambah Resep",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-primary",disabled:!y,onClick:()=>A(),children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{d:"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"})})})})]})})})})]}),(0,r.jsxs)("table",{className:"table table-sm table-zebra",children:[r.jsx("thead",{className:"bg-base-200",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"No"}),r.jsx("th",{children:"Nama Obat"}),r.jsx("th",{children:"Jumlah"}),r.jsx("th",{children:"Satuan"}),r.jsx("th",{children:"Signa 1"}),r.jsx("th",{}),r.jsx("th",{children:"Signa 2"}),r.jsx("th",{children:"Aturan"}),r.jsx("th",{children:"Waktu"}),r.jsx("th",{children:"Catatan"}),t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("th",{children:"Aksi"})]})}),r.jsx("tbody",{children:h?.map((e,a)=>r.jsxs("tr",{children:[r.jsx("td",{children:a+1}),r.jsxs("td",{children:[r.jsx("div",{className:"font-bold",children:e?.namaObat?.toString()||"Unknown Obat"}),r.jsxs("div",{className:"text-sm opacity-50",children:["Stok: ",e?.stok??"N/A"]})]}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"jumlah",e.id),className:"input input-sm input-primary w-14",defaultValue:e.jumlah?.toString()})}),r.jsx("td",{children:e.satuan}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"signa1",e.id),className:"input input-sm input-primary w-14",defaultValue:e.signa1?.toString()})}),r.jsx("td",{children:"X"}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"signa2",e.id),className:"input input-sm input-primary w-14",defaultValue:e.signa2?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"aturanPakai",e.id),className:"input input-sm input-primary w-40",defaultValue:e.aturanPakai?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"waktu",e.id),className:"input input-sm input-primary w-32",defaultValue:e.waktu?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>B(t.target.value,"catatan",e.id),className:"input input-sm input-primary w-32",defaultValue:e.catatan?.toString()})}),t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("td",{className:"tooltip tooltip-left","data-tip":"Hapus Resep",children:r.jsx("button",{onClick:()=>O(Number(e.id)),className:"btn btn-xs btn-error btn-circle ",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"})})})})]},e.obatId))})]})]}),a.isBillingFarmasi?(0,r.jsxs)("div",{className:"flex flex-col gap-3 mt-5",children:[r.jsx("button",{className:"btn btn-error btn-sm",children:"SUDAH TRANSAKSI"}),r.jsx("button",{className:"btn btn-info btn-sm",onClick:()=>q(),children:"CETAK BILL"})]}):t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("button",{onClick:()=>I(),className:"btn btn-primary btn-sm mt-10",children:"SIMPAN TRANSAKSI"}),r.jsx(c,{billFarmasi:w,pasien:u})]})}},57371:(e,t,a)=>{"use strict";a.d(t,{default:()=>s.a});var r=a(670),s=a.n(r)},670:(e,t,a)=>{"use strict";let{createProxy:r}=a(68570);e.exports=r("E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\CMS LOCAL TEST\\fe-klinik\\node_modules\\next\\dist\\client\\link.js")},86929:(e,t,a)=>{"use strict";a.r(t),a.d(t,{getTransaksiFarmasi:()=>i});var r=a(27745);a(26461);var s=a(20439);async function i(e){try{let t=await s.default.billPasien.findFirst({where:{pendaftaranId:Number(e)},include:{billPasienDetail:{where:{jenisBill:"OBAT"}}}});return{status:!0,message:"Berhasil",data:t}}catch(e){return{status:!1,message:e,data:"null"}}}(0,a(85723).ensureServerEntryExports)([i]),(0,r.registerServerReference)("2c649e101c1182e70ea6174575fc5fe9faab832b",i)},60248:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(19510),s=a(68273),i=a(56106),n=a(35089),l=a(75571),o=a(68570);let d=(0,o.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\CMS LOCAL TEST\fe-klinik\src\app\klinik\farmasi\pageclient\FormTransaksiResep.tsx`),{__esModule:u,$$typeof:c}=d;d.default;let m=(0,o.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\CMS LOCAL TEST\fe-klinik\src\app\klinik\farmasi\pageclient\FormTransaksiResep.tsx#default`);var p=a(57371);let h=async e=>{try{let t=await fetch(`http://localhost:8000/pasien/byid/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return[];return t.json()}catch(e){return console.log(e),[]}},x=async e=>{try{let t=await fetch(`http://localhost:8000/cppt/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return[];return t.json()}catch(e){return console.log(e),[]}},f=async e=>{try{let t=await fetch(`http://localhost:8000/resep/bysoap/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return null;return t.json()}catch(e){return console.log(e),null}},b=async({params:e})=>{let t=e.id[0],a=e.id[1],o=e.id[2],d=await (0,l.getServerSession)(n.A),u=await f(t),c=await x(t),b=await h(a);return(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[r.jsx(p.default,{href:"/klinik/farmasi",children:(0,r.jsxs)("button",{className:"btn btn-sm btn-primary",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{fillRule:"evenodd",d:"M12.5 9.75A2.75 2.75 0 0 0 9.75 7H4.56l2.22 2.22a.75.75 0 1 1-1.06 1.06l-3.5-3.5a.75.75 0 0 1 0-1.06l3.5-3.5a.75.75 0 0 1 1.06 1.06L4.56 5.5h5.19a4.25 4.25 0 0 1 0 8.5h-1a.75.75 0 0 1 0-1.5h1a2.75 2.75 0 0 0 2.75-2.75Z",clipRule:"evenodd"})}),"Kembali"]})}),r.jsx(s.Z,{pasien:b}),r.jsx(i.Z,{message:"Transaksi Resep!"}),r.jsx(m,{pasien:b,soap:c,data:u,session:d,pendaftaranId:o})]})}},20439:(e,t,a)=>{"use strict";a.d(t,{default:()=>s});var r=a(53524);let s=globalThis.prismaGlobal??new r.PrismaClient}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5819,3838,2857,2481,7396,3118,5194,362,2121,265],()=>a(78849));module.exports=r})();