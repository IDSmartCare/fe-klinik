(()=>{var e={};e.id=5671,e.ids=[5671],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},22721:e=>{"use strict";e.exports=require("@react-pdf/renderer")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},82699:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),a(60248),a(28268),a(44465),a(35866);var r=a(23191),n=a(88716),s=a(37922),i=a.n(s),l=a(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["klinik",{children:["farmasi",{children:["resep",{children:["[...id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,60248)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\klinik\\farmasi\\resep\\[...id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,28268)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\klinik\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,44465)),"E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["E:\\Adis\\Development\\_KANTOR\\Core ID Smart Care\\fe-klinik\\src\\app\\klinik\\farmasi\\resep\\[...id]\\page.tsx"],c="/klinik/farmasi/resep/[...id]/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/klinik/farmasi/resep/[...id]/page",pathname:"/klinik/farmasi/resep/[...id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},95058:(e,t,a)=>{let r={"616f03645a2985472bb4c6ae996d2be31a701d41":()=>Promise.resolve().then(a.bind(a,86929)).then(e=>e.getTransaksiFarmasi)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"616f03645a2985472bb4c6ae996d2be31a701d41":n.bind(null,"616f03645a2985472bb4c6ae996d2be31a701d41")}},5059:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,79404,23)),Promise.resolve().then(a.bind(a,31262))},33265:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var r=a(43353),n=a.n(r)},43353:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=a(98052);a(10326),a(17577);let n=r._(a(77028));function s(e,t){var a;let r={loading:e=>{let{error:t,isLoading:a,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let s={...r,...t};return(0,n.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let r=a(94129);function n(e){let{reason:t,children:a}=e;throw new r.BailoutToCSRError(t)}},77028:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=a(10326),n=a(17577),s=a(933),i=a(46618);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,n.lazy)(()=>t.loader().then(l)),d=t.loading;function u(e){let l=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.PreloadCss,{moduleIds:t.modules}),(0,r.jsx)(a,{...e})]}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(n.Suspense,{fallback:l,children:o})}return u.displayName="LoadableComponent",u}},46618:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return s}});let r=a(10326),n=a(55403);function s(e){let{moduleIds:t}=e,a=(0,n.getExpectedRequestStore)("next/dynamic css"),s=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));s.push(...t)}}return 0===s.length?null:(0,r.jsx)(r.Fragment,{children:s.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},31262:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var r=a(10326),n=a(17577),s=a(62379),i=a(66802),l=a(32859);a(15424);var o=(0,a(46242).$)("616f03645a2985472bb4c6ae996d2be31a701d41"),d=a(22721);let u=(0,a(33265).default)(async()=>{},{loadableGenerated:{modules:["app\\klinik\\farmasi\\pageclient\\ModalPrintBillFarmasi.tsx -> @react-pdf/renderer"]},ssr:!1,loading:()=>r.jsx("p",{children:"Loading..."})}),c=({billFarmasi:e,pasien:t})=>{e?.data.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0);let a=d.StyleSheet.create({page:{padding:30},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},companyInfo:{width:"40%"},customerInfo:{textAlign:"right",width:"60%"},logo:{width:100,height:100},title:{fontSize:24,marginBottom:10,textAlign:"center"},item:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#ddd",marginBottom:5,paddingBottom:5},itemName:{width:"70%"},itemPrice:{textAlign:"right",width:"30%"},total:{fontSize:18,marginTop:20}});return r.jsx("dialog",{id:"modal-print-bill-farmasi",className:"modal",children:(0,r.jsxs)("div",{className:"modal-box w-8/12 max-w-2xl",children:[r.jsx("form",{method:"dialog",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"âœ•"})}),r.jsx(u,{className:"w-full h-80",children:r.jsx(d.Document,{children:(0,r.jsxs)(d.Page,{style:a.page,children:[r.jsx(d.Text,{style:a.title,children:"Resep Obat"}),r.jsx(d.View,{style:a.item,children:r.jsx(d.Text,{style:a.itemName,children:"Item"})}),e?.data.billPasienDetail.map(e=>r.jsx(d.View,{style:a.item,children:r.jsx(d.Text,{style:a.itemName,children:e.deskripsi})},e.id))]})})})]})})};var p=a(35047),m=a(12919);let h=({data:e,session:t,soap:a,pendaftaranId:d,pasien:u})=>{let[h,f]=(0,n.useState)(null),[b,x]=(0,n.useState)({}),[g,j]=(0,n.useState)(!1),[y,k]=(0,n.useState)(!1),[w,v]=(0,n.useState)(),[P,_]=(0,n.useState)(!1),N=(0,n.useId)(),O=(0,p.useRouter)();(0,n.useEffect)(()=>{P?f([]):f(e??[])},[e,P]);let C=async e=>e.length>=2?(await (0,i.P)({url:`master-barang?wfid=${t?.user.wfid}&search=${e}`})).data.data.map(e=>({value:e.barang_id,label:`${e.barang.nama_barang} (${e.barang.satuan})`,satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})):(await (0,i.P)({url:`master-barang?wfid=${t?.user.wfid}`})).data.data.map(e=>({value:e.barang_id,label:`${e.barang.nama_barang} (${e.barang.satuan})`,satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})),S=e=>{e?(x({namaObat:e.label,obatId:e.value,satuan:e.satuan,harga_jual:e.harga_jual,stok:e.stok}),k(!0)):k(!1)},A=()=>{let e={id:Math.random(),namaObat:b.namaObat,obatId:b.obatId,satuan:b.satuan,jumlah:0,signa1:"",signa2:"",aturanPakai:"",waktu:"",catatan:"",hargaJual:b.harga_jual,sOAPId:Number(a.id),createdAt:new Date,updatedAt:new Date,stok:b.stok};h?f([...h,e]):f([e])},T=e=>{h?f([...h.filter(t=>t.id!==e)]):f([])},B=async()=>{if(j(!g),h?.some(e=>0===Number(e.jumlah))){(0,l.o)({icon:"error",title:"Barang tidak boleh berjumlah 0!"});return}let e=h?.map(e=>({...e,total:Number(e.hargaJual)*Number(e.jumlah),pendaftaranId:d})),r={barang:h?.map(e=>({barang_id:e.obatId,nama_obat:e.namaObat,qty:e.jumlah})),wfid:t?.user.wfid};if((await m.Z.fire({title:"Yakin?",text:"Apakah anda yakin ingin menyimpan transaksi ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Iya",cancelButtonText:"Tidak"})).isConfirmed)try{let t=await (0,i.n)({url:"decrease-stock",data:r});if(!t.status){(0,l.o)({icon:"error",title:t.message?t.message:"Silahkan pilih obat terlebih dahulu"});return}if(!(await fetch(`/api/resep/add?idsoap=${a.id}&idpendaftaran=${d}`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).ok){(0,l.o)({icon:"error",title:"Gagal simpan data!"});return}(0,l.o)({icon:"success",title:"Berhasil!"}),O.refresh(),_(!0)}catch(e){console.log(e),(0,l.o)({icon:"error",title:"string"==typeof e.message?e.message:"Terjadi kesalahan!"})}},q=(e,t,a)=>{if(e&&h){let r=h?.findIndex(e=>e.id===a);"jumlah"===t?h[r].jumlah=Number(e):"signa1"===t?h[r].signa1=e:"signa2"===t?h[r].signa2=e:"aturanPakai"===t?h[r].aturanPakai=e:"waktu"===t?h[r].waktu=e:h[r].catatan=e}},I=async()=>{let e=await o(d);e.status?((0,l.o)({icon:"success",title:"Berhasil!"}),v(e),await new Promise(e=>setTimeout(e,2e3)),(document?.getElementById("modal-print-bill-farmasi")).showModal()):(0,l.o)({icon:"error",title:"Gagal ambil data!"})};return(0,r.jsxs)("div",{className:"flex flex-col",children:[!a.isBillingFarmasi&&(0,r.jsxs)("div",{children:[t?.user.role!=="admin"&&(0,r.jsxs)("table",{className:"table table-sm table-zebra mb-8",children:[r.jsx("thead",{className:"bg-base-200",children:r.jsx("tr",{children:r.jsx("th",{colSpan:2,children:"Tambah Obat Baru"})})}),r.jsx("tbody",{children:r.jsx("tr",{className:"bg-info",children:r.jsx("td",{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(s.Z,{className:"select-info w-full",required:!0,isClearable:!0,name:"obat",loadOptions:e=>new Promise(t=>{setTimeout(()=>{t(C(e))},1e3)}),defaultOptions:!0,onChange:e=>S(e),placeholder:"Cari obat",instanceId:N}),t?.user.role!=="tester"&&t?.user.role!=="admin"&&r.jsx("div",{className:"tooltip tooltip-left w-20","data-tip":"Tambah Resep",children:r.jsx("button",{className:"btn btn-sm btn-circle btn-primary",disabled:!y,onClick:()=>A(),children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{d:"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"})})})})]})})})})]}),(0,r.jsxs)("table",{className:"table table-sm table-zebra",children:[r.jsx("thead",{className:"bg-base-200",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"No"}),r.jsx("th",{children:"Nama Obat"}),r.jsx("th",{children:"Jumlah"}),r.jsx("th",{children:"Satuan"}),r.jsx("th",{children:"Signa 1"}),r.jsx("th",{}),r.jsx("th",{children:"Signa 2"}),r.jsx("th",{children:"Aturan"}),r.jsx("th",{children:"Waktu"}),r.jsx("th",{children:"Catatan"}),t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("th",{children:"Aksi"})]})}),r.jsx("tbody",{children:h?.map((e,a)=>r.jsxs("tr",{children:[r.jsx("td",{children:a+1}),r.jsxs("td",{children:[r.jsx("div",{className:"font-bold",children:e?.namaObat?.toString()||"Unknown Obat"}),r.jsxs("div",{className:"text-sm opacity-50",children:["Stok: ",e?.stok??"N/A"]})]}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"jumlah",e.id),className:"input input-sm input-primary w-14",defaultValue:e.jumlah?.toString()})}),r.jsx("td",{children:e.satuan}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"signa1",e.id),className:"input input-sm input-primary w-14",defaultValue:e.signa1?.toString()})}),r.jsx("td",{children:"X"}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"signa2",e.id),className:"input input-sm input-primary w-14",defaultValue:e.signa2?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"aturanPakai",e.id),className:"input input-sm input-primary w-40",defaultValue:e.aturanPakai?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"waktu",e.id),className:"input input-sm input-primary w-32",defaultValue:e.waktu?.toString()})}),r.jsx("td",{children:r.jsx("input",{type:"text",onChange:t=>q(t.target.value,"catatan",e.id),className:"input input-sm input-primary w-32",defaultValue:e.catatan?.toString()})}),t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("td",{className:"tooltip tooltip-left","data-tip":"Hapus Resep",children:r.jsx("button",{onClick:()=>T(Number(e.id)),className:"btn btn-xs btn-error btn-circle ",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"})})})})]},e.obatId))})]})]}),a.isBillingFarmasi?r.jsx("div",{className:"flex flex-col gap-3 mt-5",children:r.jsx("button",{className:"btn btn-info btn-sm",onClick:()=>I(),children:"CETAK RESEP"})}):t?.user.role!=="admin"&&t?.user.role!=="tester"&&r.jsx("button",{onClick:()=>B(),className:"btn btn-primary btn-sm mt-10",children:"SIMPAN TRANSAKSI"}),r.jsx(c,{billFarmasi:w,pasien:u})]})}},69955:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},75571:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.default}});var n=a(69955);Object.keys(n).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e))&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))});var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=i(void 0);if(a&&a.has(e))return a.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&({}).hasOwnProperty.call(e,s)){var l=n?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(r,s,l):r[s]=e[s]}return r.default=e,a&&a.set(e,r),r}(a(45609));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(i=function(e){return e?a:t})(e)}Object.keys(s).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e))&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))})},86929:(e,t,a)=>{"use strict";a.r(t),a.d(t,{getTransaksiFarmasi:()=>s});var r=a(27745);a(26461);var n=a(20439);async function s(e){try{let t=await n.default.billPasien.findFirst({where:{pendaftaranId:Number(e)},include:{billPasienDetail:{where:{jenisBill:"OBAT"}}}});return{status:!0,message:"Berhasil",data:t}}catch(e){return{status:!1,message:e,data:"null"}}}(0,a(85723).ensureServerEntryExports)([s]),(0,r.registerServerReference)("616f03645a2985472bb4c6ae996d2be31a701d41",s)},60248:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(19510),n=a(68273),s=a(56106),i=a(35089),l=a(75571),o=a(68570);let d=(0,o.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\klinik\farmasi\pageclient\FormTransaksiResep.tsx`),{__esModule:u,$$typeof:c}=d;d.default;let p=(0,o.createProxy)(String.raw`E:\Adis\Development\_KANTOR\Core ID Smart Care\fe-klinik\src\app\klinik\farmasi\pageclient\FormTransaksiResep.tsx#default`);var m=a(57371);let h=async e=>{try{let t=await fetch(`http://localhost:8000/pasien/byid/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return[];return t.json()}catch(e){return console.log(e),[]}},f=async e=>{try{let t=await fetch(`http://localhost:8000/cppt/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return[];return t.json()}catch(e){return console.log(e),[]}},b=async e=>{try{let t=await fetch(`http://localhost:8000/resep/bysoap/${e}`,{headers:{Authorization:"Bearer testing"}});if(!t.ok)return null;return t.json()}catch(e){return console.log(e),null}},x=async({params:e})=>{let t=e.id[0],a=e.id[1],o=e.id[2],d=await (0,l.getServerSession)(i.A),u=await b(t),c=await f(t),x=await h(a);return(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[r.jsx(m.default,{href:"/klinik/farmasi",children:(0,r.jsxs)("button",{className:"btn btn-sm btn-primary",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:r.jsx("path",{fillRule:"evenodd",d:"M12.5 9.75A2.75 2.75 0 0 0 9.75 7H4.56l2.22 2.22a.75.75 0 1 1-1.06 1.06l-3.5-3.5a.75.75 0 0 1 0-1.06l3.5-3.5a.75.75 0 0 1 1.06 1.06L4.56 5.5h5.19a4.25 4.25 0 0 1 0 8.5h-1a.75.75 0 0 1 0-1.5h1a2.75 2.75 0 0 0 2.75-2.75Z",clipRule:"evenodd"})}),"Kembali"]})}),r.jsx(n.Z,{pasien:x}),r.jsx(s.Z,{message:"Transaksi Resep!"}),r.jsx(p,{pasien:x,soap:c,data:u,session:d,pendaftaranId:o})]})}},20439:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(53524);let n=globalThis.prismaGlobal??new r.PrismaClient}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5819,6621,2481,2857,9404,7787,5001,517,362,2007,6763],()=>a(82699));module.exports=r})();