(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5671],{42480:function(){},34283:function(e,t,a){Promise.resolve().then(a.t.bind(a,231,23)),Promise.resolve().then(a.bind(a,53218))},57818:function(e,t,a){"use strict";a.d(t,{default:function(){return i.a}});var n=a(50551),i=a.n(n)},58064:function(e,t,a){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return i}});let n=a(74590);function i(e){let{createServerReference:t}=a(6671);return t(e,n.callServer)}},50551:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let n=a(51609);a(57437),a(2265);let i=n._(a(40148));function l(e,t){var a;let n={loading:e=>{let{error:t,isLoading:a,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let l={...n,...t};return(0,i.default)({...l,modules:null==(a=l.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10912:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return i}});let n=a(55592);function i(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return a}},40148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let n=a(57437),i=a(2265),l=a(10912),r=a(61481);function s(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},u=function(e){let t={...o,...e},a=(0,i.lazy)(()=>t.loader().then(s)),u=t.loading;function d(e){let s=u?(0,n.jsx)(u,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(r.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(a,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(a,{...e})});return(0,n.jsx)(i.Suspense,{fallback:s,children:o})}return d.displayName="LoadableComponent",d}},61481:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let n=a(57437),i=a(58512);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,i.getExpectedRequestStore)("next/dynamic css"),l=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,n.jsx)(n.Fragment,{children:l.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},66781:function(e,t,a){"use strict";a.d(t,{Z:function(){return h}});var n=a(22988),i=a(2265),l=a(43139),r=a(17792),s=a(12475),o=a(42897),u=a(80373),d=a(135),c=a(44390),m=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];a(54887),a(92658);var h=(0,i.forwardRef)(function(e,t){var a,h,f,b,p,g,x,j,v,y,w,N,S,k,C,O,P,I,T,_,B,A,R,Z,D,L,M,E,V,z,F,J,q,G,K,U,W,H,$,X,Y,Q,ee,et,ea,en,ei,el,er,es,eo,eu=(h=void 0!==(a=e.defaultOptions)&&a,b=void 0!==(f=e.cacheOptions)&&f,p=e.loadOptions,e.options,g=e.isLoading,x=e.onInputChange,j=e.filterOption,y=(v=(0,d.Z)(e,m)).inputValue,w=(0,i.useRef)(void 0),N=(0,i.useRef)(!1),S=(0,i.useState)(Array.isArray(h)?h:void 0),C=(k=(0,u.Z)(S,2))[0],O=k[1],P=(0,i.useState)(void 0!==y?y:""),T=(I=(0,u.Z)(P,2))[0],_=I[1],B=(0,i.useState)(!0===h),R=(A=(0,u.Z)(B,2))[0],Z=A[1],D=(0,i.useState)(void 0),M=(L=(0,u.Z)(D,2))[0],E=L[1],V=(0,i.useState)([]),F=(z=(0,u.Z)(V,2))[0],J=z[1],q=(0,i.useState)(!1),K=(G=(0,u.Z)(q,2))[0],U=G[1],W=(0,i.useState)({}),$=(H=(0,u.Z)(W,2))[0],X=H[1],Y=(0,i.useState)(void 0),ee=(Q=(0,u.Z)(Y,2))[0],et=Q[1],ea=(0,i.useState)(void 0),ei=(en=(0,u.Z)(ea,2))[0],el=en[1],b!==ei&&(X({}),el(b)),h!==ee&&(O(Array.isArray(h)?h:void 0),et(h)),(0,i.useEffect)(function(){return N.current=!0,function(){N.current=!1}},[]),er=(0,i.useCallback)(function(e,t){if(!p)return t();var a=p(e,t);a&&"function"==typeof a.then&&a.then(t,function(){return t()})},[p]),(0,i.useEffect)(function(){!0===h&&er(T,function(e){N.current&&(O(e||[]),Z(!!w.current))})},[]),es=(0,i.useCallback)(function(e,t){var a=(0,c.L)(e,t,x);if(!a){w.current=void 0,_(""),E(""),J([]),Z(!1),U(!1);return}if(b&&$[a])_(a),E(a),J($[a]),Z(!1),U(!1);else{var n=w.current={};_(a),Z(!0),U(!M),er(a,function(e){N&&n===w.current&&(w.current=void 0,Z(!1),E(a),J(e||[]),U(!1),X(e?(0,o.Z)((0,o.Z)({},$),{},(0,s.Z)({},a,e)):$))})}},[b,er,M,$,x]),eo=K?[]:T&&M?F:C||[],(0,o.Z)((0,o.Z)({},v),{},{options:eo,isLoading:R||void 0!==g&&g,onInputChange:es,filterOption:void 0===j?null:j})),ed=(0,r.u)(eu);return i.createElement(l.S,(0,n.Z)({ref:t},ed))})},75162:function(e,t,a){"use strict";a.d(t,{o:function(){return l}});var n=a(64379),i=a.n(n);function l(e){let{icon:t,title:a}=e;i().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=i().stopTimer,e.onmouseleave=i().resumeTimer}}).fire({icon:t,title:a})}},53218:function(e,t,a){"use strict";a.d(t,{default:function(){return b}});var n=a(57437),i=a(2265),l=a(66781),r=a(41317),s=a(75162);a(74590);var o=(0,a(58064).$)("616f03645a2985472bb4c6ae996d2be31a701d41"),u=a(5100);let d=(0,a(57818).default)(()=>Promise.resolve().then(a.bind(a,5100)).then(e=>e.PDFViewer),{loadableGenerated:{webpack:()=>[null]},ssr:!1,loading:()=>(0,n.jsx)("p",{children:"Loading..."})});var c=e=>{let{billFarmasi:t,pasien:a}=e,i=null==t?void 0:t.data.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0),l=u.StyleSheet.create({page:{padding:30},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},companyInfo:{width:"40%"},customerInfo:{textAlign:"right",width:"60%"},logo:{width:100,height:100},title:{fontSize:24,marginBottom:10,textAlign:"center"},item:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#ddd",marginBottom:5,paddingBottom:5},itemName:{width:"70%"},itemPrice:{textAlign:"right",width:"30%"},total:{fontSize:18,marginTop:20}});return(0,n.jsx)("dialog",{id:"modal-print-bill-farmasi",className:"modal",children:(0,n.jsxs)("div",{className:"modal-box w-8/12 max-w-2xl",children:[(0,n.jsx)("form",{method:"dialog",children:(0,n.jsx)("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"âœ•"})}),(0,n.jsx)(d,{className:"w-full h-80",children:(0,n.jsx)(u.Document,{children:(0,n.jsxs)(u.Page,{style:l.page,children:[(0,n.jsx)(u.Text,{style:l.title,children:"Invoice Obat"}),(0,n.jsxs)(u.View,{style:l.item,children:[(0,n.jsx)(u.Text,{style:l.itemName,children:"Item"}),(0,n.jsx)(u.Text,{style:l.itemPrice,children:"Sub Total"})]}),null==t?void 0:t.data.billPasienDetail.map(e=>(0,n.jsxs)(u.View,{style:l.item,children:[(0,n.jsxs)(u.Text,{style:l.itemName,children:[e.deskripsi," ",e.jumlah,"@",e.harga]}),(0,n.jsx)(u.Text,{style:l.itemPrice,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.subTotal))})]},e.id)),(0,n.jsxs)(u.Text,{style:l.total,children:["Total: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(i))]})]})})})]})})},m=a(16463),h=a(64379),f=a.n(h),b=e=>{let{data:t,session:a,soap:u,pendaftaranId:d,pasien:h}=e,[b,p]=(0,i.useState)(null),[g,x]=(0,i.useState)({}),[j,v]=(0,i.useState)(!1),[y,w]=(0,i.useState)(!1),[N,S]=(0,i.useState)(),[k,C]=(0,i.useState)(!1),O=(0,i.useId)(),P=(0,m.useRouter)();(0,i.useEffect)(()=>{k?p([]):p(null!=t?t:[])},[t,k]);let I=async e=>e.length>=2?(await (0,r.P)({url:"master-barang?wfid=".concat(null==a?void 0:a.user.wfid,"&search=").concat(e)})).data.data.map(e=>({value:e.barang_id,label:"".concat(e.barang.nama_barang," (").concat(e.barang.satuan,")"),satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})):(await (0,r.P)({url:"master-barang?wfid=".concat(null==a?void 0:a.user.wfid)})).data.data.map(e=>({value:e.barang_id,label:"".concat(e.barang.nama_barang," (").concat(e.barang.satuan,")"),satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})),T=e=>{e?(x({namaObat:e.label,obatId:e.value,satuan:e.satuan,harga_jual:e.harga_jual,stok:e.stok}),w(!0)):w(!1)},_=()=>{let e={id:Math.random(),namaObat:g.namaObat,obatId:g.obatId,satuan:g.satuan,jumlah:0,signa1:"",signa2:"",aturanPakai:"",waktu:"",catatan:"",hargaJual:g.harga_jual,sOAPId:Number(u.id),createdAt:new Date,updatedAt:new Date,stok:g.stok};b?p([...b,e]):p([e])},B=e=>{b?p([...b.filter(t=>t.id!==e)]):p([])},A=async()=>{if(v(!j),null==b?void 0:b.some(e=>0===Number(e.jumlah))){(0,s.o)({icon:"error",title:"Barang tidak boleh berjumlah 0!"});return}let e=null==b?void 0:b.map(e=>({...e,total:Number(e.hargaJual)*Number(e.jumlah),pendaftaranId:d})),t={barang:null==b?void 0:b.map(e=>({barang_id:e.obatId,nama_obat:e.namaObat,qty:e.jumlah})),wfid:null==a?void 0:a.user.wfid};if((await f().fire({title:"Yakin?",text:"Apakah anda yakin ingin menyimpan transaksi ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Iya",cancelButtonText:"Tidak"})).isConfirmed)try{let a=await (0,r.n)({url:"decrease-stock",data:t});if(!a.status){(0,s.o)({icon:"error",title:a.message?a.message:"Silahkan pilih obat terlebih dahulu"});return}if(!(await fetch("/api/resep/add?idsoap=".concat(u.id,"&idpendaftaran=").concat(d),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).ok){(0,s.o)({icon:"error",title:"Gagal simpan data!"});return}(0,s.o)({icon:"success",title:"Berhasil!"}),P.refresh(),C(!0)}catch(e){console.log(e),(0,s.o)({icon:"error",title:"string"==typeof e.message?e.message:"Terjadi kesalahan!"})}},R=(e,t,a)=>{if(e&&b){let n=null==b?void 0:b.findIndex(e=>e.id===a);"jumlah"===t?b[n].jumlah=Number(e):"signa1"===t?b[n].signa1=e:"signa2"===t?b[n].signa2=e:"aturanPakai"===t?b[n].aturanPakai=e:"waktu"===t?b[n].waktu=e:b[n].catatan=e}},Z=async()=>{let e=await o(d);if(e.status){var t;(0,s.o)({icon:"success",title:"Berhasil!"}),S(e),await new Promise(e=>setTimeout(e,2e3)),(null===(t=document)||void 0===t?void 0:t.getElementById("modal-print-bill-farmasi")).showModal()}else(0,s.o)({icon:"error",title:"Gagal ambil data!"})};return(0,n.jsxs)("div",{className:"flex flex-col",children:[!u.isBillingFarmasi&&(0,n.jsxs)("div",{children:[(null==a?void 0:a.user.role)!=="admin"&&(0,n.jsxs)("table",{className:"table table-sm table-zebra mb-8",children:[(0,n.jsx)("thead",{className:"bg-base-200",children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{colSpan:2,children:"Tambah Obat Baru"})})}),(0,n.jsx)("tbody",{children:(0,n.jsx)("tr",{className:"bg-info",children:(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(l.Z,{className:"select-info w-full",required:!0,isClearable:!0,name:"obat",loadOptions:e=>new Promise(t=>{setTimeout(()=>{t(I(e))},1e3)}),defaultOptions:!0,onChange:e=>T(e),placeholder:"Cari obat",instanceId:O}),(null==a?void 0:a.user.role)!=="tester"&&(null==a?void 0:a.user.role)!=="admin"&&(0,n.jsx)("div",{className:"tooltip tooltip-left w-20","data-tip":"Tambah Resep",children:(0,n.jsx)("button",{className:"btn btn-sm btn-circle btn-primary",disabled:!y,onClick:()=>_(),children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:(0,n.jsx)("path",{d:"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"})})})})]})})})})]}),(0,n.jsxs)("table",{className:"table table-sm table-zebra",children:[(0,n.jsx)("thead",{className:"bg-base-200",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"No"}),(0,n.jsx)("th",{children:"Nama Obat"}),(0,n.jsx)("th",{children:"Jumlah"}),(0,n.jsx)("th",{children:"Satuan"}),(0,n.jsx)("th",{children:"Signa 1"}),(0,n.jsx)("th",{}),(0,n.jsx)("th",{children:"Signa 2"}),(0,n.jsx)("th",{children:"Aturan"}),(0,n.jsx)("th",{children:"Waktu"}),(0,n.jsx)("th",{children:"Catatan"}),(null==a?void 0:a.user.role)!=="admin"&&(null==a?void 0:a.user.role)!=="tester"&&(0,n.jsx)("th",{children:"Aksi"})]})}),(0,n.jsx)("tbody",{children:null==b?void 0:b.map((e,t)=>{var i,l,r,s,o,u,d,c;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:t+1}),(0,n.jsxs)("td",{children:[(0,n.jsx)("div",{className:"font-bold",children:(null==e?void 0:null===(i=e.namaObat)||void 0===i?void 0:i.toString())||"Unknown Obat"}),(0,n.jsxs)("div",{className:"text-sm opacity-50",children:["Stok: ",null!==(c=null==e?void 0:e.stok)&&void 0!==c?c:"N/A"]})]}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"jumlah",e.id),className:"input input-sm input-primary w-14",defaultValue:null===(l=e.jumlah)||void 0===l?void 0:l.toString()})}),(0,n.jsx)("td",{children:e.satuan}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"signa1",e.id),className:"input input-sm input-primary w-14",defaultValue:null===(r=e.signa1)||void 0===r?void 0:r.toString()})}),(0,n.jsx)("td",{children:"X"}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"signa2",e.id),className:"input input-sm input-primary w-14",defaultValue:null===(s=e.signa2)||void 0===s?void 0:s.toString()})}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"aturanPakai",e.id),className:"input input-sm input-primary w-40",defaultValue:null===(o=e.aturanPakai)||void 0===o?void 0:o.toString()})}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"waktu",e.id),className:"input input-sm input-primary w-32",defaultValue:null===(u=e.waktu)||void 0===u?void 0:u.toString()})}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"text",onChange:t=>R(t.target.value,"catatan",e.id),className:"input input-sm input-primary w-32",defaultValue:null===(d=e.catatan)||void 0===d?void 0:d.toString()})}),(null==a?void 0:a.user.role)!=="admin"&&(null==a?void 0:a.user.role)!=="tester"&&(0,n.jsx)("td",{className:"tooltip tooltip-left","data-tip":"Hapus Resep",children:(0,n.jsx)("button",{onClick:()=>B(Number(e.id)),className:"btn btn-xs btn-error btn-circle ",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:(0,n.jsx)("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"})})})})]},e.obatId)})})]})]}),u.isBillingFarmasi?(0,n.jsxs)("div",{className:"flex flex-col gap-3 mt-5",children:[(0,n.jsx)("button",{className:"btn btn-error btn-sm",children:"SUDAH TRANSAKSI"}),(0,n.jsx)("button",{className:"btn btn-info btn-sm",onClick:()=>Z(),children:"CETAK BILL"})]}):(null==a?void 0:a.user.role)!=="admin"&&(null==a?void 0:a.user.role)!=="tester"&&(0,n.jsx)("button",{onClick:()=>A(),className:"btn btn-primary btn-sm mt-10",children:"SIMPAN TRANSAKSI"}),(0,n.jsx)(c,{billFarmasi:N,pasien:h})]})}},41317:function(e,t,a){"use strict";a.d(t,{P:function(){return n},n:function(){return i}});let n=async e=>{let{url:t}=e;try{let e=await fetch("".concat("http://localhost:8001/api","/").concat(t),{headers:{"Content-Type":"application/json",Authorization:"".concat("IDsM4RtcaR32024*@>")}});if(!e.ok)return console.error("Error: ".concat(e.status," - ").concat(e.statusText)),null;return await e.json()}catch(e){return console.error("Failed to fetch data:",e),null}},i=async e=>{let{url:t,data:a}=e;try{let e=await fetch("".concat("http://localhost:8001/api","/").concat(t),{headers:{"Content-Type":"application/json",Authorization:"".concat("IDsM4RtcaR32024*@>")},method:"POST",body:JSON.stringify(a)});return await e.json()}catch(e){return null}}}},function(e){e.O(0,[9461,249,7448,7282,231,5151,5457,2971,7023,1744],function(){return e(e.s=34283)}),_N_E=e.O()}]);