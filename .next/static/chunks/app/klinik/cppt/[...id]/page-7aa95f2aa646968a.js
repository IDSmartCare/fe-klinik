(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6919],{5986:function(e,a,t){Promise.resolve().then(t.bind(t,1200))},6781:function(e,a,t){"use strict";t.d(a,{Z:function(){return h}});var s=t(2988),l=t(2265),n=t(3139),r=t(7792),i=t(2475),o=t(2897),c=t(373),u=t(135),d=t(4390),m=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];t(4887),t(2658);var h=(0,l.forwardRef)(function(e,a){var t,h,x,p,b,f,v,j,g,N,k,w,y,S,C,O,Z,_,P,I,D,R,T,A,M,E,L,B,q,V,z,F,J,G,H,X,K,W,Q,U,Y,$,ee,ea,et,es,el,en,er,ei,eo,ec=(h=void 0!==(t=e.defaultOptions)&&t,p=void 0!==(x=e.cacheOptions)&&x,b=e.loadOptions,e.options,f=e.isLoading,v=e.onInputChange,j=e.filterOption,N=(g=(0,u.Z)(e,m)).inputValue,k=(0,l.useRef)(void 0),w=(0,l.useRef)(!1),y=(0,l.useState)(Array.isArray(h)?h:void 0),C=(S=(0,c.Z)(y,2))[0],O=S[1],Z=(0,l.useState)(void 0!==N?N:""),P=(_=(0,c.Z)(Z,2))[0],I=_[1],D=(0,l.useState)(!0===h),T=(R=(0,c.Z)(D,2))[0],A=R[1],M=(0,l.useState)(void 0),L=(E=(0,c.Z)(M,2))[0],B=E[1],q=(0,l.useState)([]),z=(V=(0,c.Z)(q,2))[0],F=V[1],J=(0,l.useState)(!1),H=(G=(0,c.Z)(J,2))[0],X=G[1],K=(0,l.useState)({}),Q=(W=(0,c.Z)(K,2))[0],U=W[1],Y=(0,l.useState)(void 0),ee=($=(0,c.Z)(Y,2))[0],ea=$[1],et=(0,l.useState)(void 0),el=(es=(0,c.Z)(et,2))[0],en=es[1],p!==el&&(U({}),en(p)),h!==ee&&(O(Array.isArray(h)?h:void 0),ea(h)),(0,l.useEffect)(function(){return w.current=!0,function(){w.current=!1}},[]),er=(0,l.useCallback)(function(e,a){if(!b)return a();var t=b(e,a);t&&"function"==typeof t.then&&t.then(a,function(){return a()})},[b]),(0,l.useEffect)(function(){!0===h&&er(P,function(e){w.current&&(O(e||[]),A(!!k.current))})},[]),ei=(0,l.useCallback)(function(e,a){var t=(0,d.L)(e,a,v);if(!t){k.current=void 0,I(""),B(""),F([]),A(!1),X(!1);return}if(p&&Q[t])I(t),B(t),F(Q[t]),A(!1),X(!1);else{var s=k.current={};I(t),A(!0),X(!L),er(t,function(e){w&&s===k.current&&(k.current=void 0,A(!1),B(t),F(e||[]),X(!1),U(e?(0,o.Z)((0,o.Z)({},Q),{},(0,i.Z)({},t,e)):Q))})}},[p,er,L,Q,v]),eo=H?[]:P&&L?z:C||[],(0,o.Z)((0,o.Z)({},g),{},{options:eo,isLoading:T||void 0!==f&&f,onInputChange:ei,filterOption:void 0===j?null:j})),eu=(0,r.u)(ec);return l.createElement(n.S,(0,s.Z)({ref:a},eu))})},6789:function(e,a,t){"use strict";t.d(a,{v:function(){return n}});var s=t(7437),l=t(4887);function n(){let{pending:e}=(0,l.useFormStatus)();return(0,s.jsx)("button",{type:"submit",className:"btn btn-sm btn-primary btn-block",disabled:e,children:"Submit"})}},5162:function(e,a,t){"use strict";t.d(a,{o:function(){return n}});var s=t(4379),l=t.n(s);function n(e){let{icon:a,title:t}=e;l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=l().stopTimer,e.onmouseleave=l().resumeTimer}}).fire({icon:a,title:t})}},1200:function(e,a,t){"use strict";t.d(a,{default:function(){return m}});var s=t(7437),l=t(6789),n=t(9343),r=t(5162),i=t(2265),o=e=>{let{message:a}=e;return(0,s.jsxs)("div",{role:"alert",className:"alert alert-error",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:a})]})},c=t(6781),u=t(1317),d=t(6463),m=e=>{let{idregis:a,session:t}=e,m=(0,i.useId)(),{register:h,handleSubmit:x,formState:{errors:p},reset:b}=(0,n.cI)(),[f,v]=(0,i.useState)([]),[j,g]=(0,i.useState)({}),[N,k]=(0,i.useState)({}),[w,y]=(0,i.useState)(""),[S,C]=(0,i.useState)(""),[O,Z]=(0,i.useState)(""),[_,P]=(0,i.useState)(""),[I,D]=(0,i.useState)(""),[R,T]=(0,i.useState)(""),A=(0,d.useRouter)(),M=async e=>{var s;let l=null===(s=N.namaDiagnosa)||void 0===s?void 0:s.split("-"),n={...e,pendaftaranId:Number(a),profesi:null==t?void 0:t.user.role,profileId:Number(null==t?void 0:t.user.idProfile),isDokter:(null==t?void 0:t.user.role)==="dokter",isVerifDokter:(null==t?void 0:t.user.role)==="dokter",jamVerifDokter:(null==t?void 0:t.user.role)==="dokter"?new Date:null,resep:f,kodeDiagnosa:N.kodeDiagnosa,namaDiagnosa:null==l?void 0:l[1],idFasyankes:null==t?void 0:t.user.idFasyankes};try{if(!(await fetch("/api/cppt/add",{method:"POST",body:JSON.stringify(n)})).ok){(0,r.o)({icon:"error",title:"Gagal simpan data!"});return}(0,r.o)({icon:"success",title:"Berhasil!"}),b(),A.refresh()}catch(e){console.log(e),(0,r.o)({icon:"error",title:e.message})}v([])},E=()=>{v([{namaObat:j.namaObat,obatId:j.obatId,jumlah:w,signa1:S,signa2:O,aturanPakai:_,waktu:I,catatan:R,satuan:j.satuan,harga_jual:j.harga_jual,stok:j.stok},...f])},L=e=>{v([...f.filter((a,t)=>t!=e)])},B=async e=>{try{if(e.length>=1)return(await (0,u.P)({url:"icdx?search=".concat(e)})).data.data.map(e=>({value:e.code,label:"".concat(e.code,"-").concat(e.en_name)}));return(await (0,u.P)({url:"icdx"})).data.data.map(e=>({value:e.code,label:"".concat(e.code,"-").concat(e.en_name)}))}catch(e){(0,r.o)({icon:"error",title:"Gagal ambil data ke server BO!"})}},q=async e=>e.length>=2?(await (0,u.P)({url:"master-barang?wfid=".concat(null==t?void 0:t.user.wfid,"&search=").concat(e)})).data.data.map(e=>({value:e.barang_id,label:"".concat(e.barang.nama_barang," (").concat(e.barang.satuan,")"),satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})):(await (0,u.P)({url:"master-barang?wfid=".concat(null==t?void 0:t.user.wfid)})).data.data.map(e=>({value:e.barang_id,label:"".concat(e.barang.nama_barang," (").concat(e.barang.satuan,")"),satuan:e.barang.satuan,harga_jual:e.barang.harga_jual,stok:e.stok})),V=e=>{e&&g({namaObat:e.label,obatId:e.value,satuan:e.satuan,harga_jual:e.harga_jual,stok:e.stok})},z=e=>{e&&k({kodeDiagnosa:e.value,namaDiagnosa:e.label})};return(0,s.jsxs)("form",{onSubmit:x(M),className:"flex items-center flex-col gap-2",children:[(0,s.jsxs)("div",{className:"join gap-2",children:[(0,s.jsxs)("div",{className:"form-control",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Subjective"})}),(0,s.jsx)("textarea",{rows:5,...h("subjective",{required:"* Tidak boleh kosong"}),className:"textarea textarea-primary"}),p.subjective&&(0,s.jsx)("label",{className:"label",children:(0,s.jsx)("span",{className:"label-text-alt text-error",children:p.subjective.message})})]}),(0,s.jsxs)("div",{className:"form-control",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Objective"})}),(0,s.jsx)("textarea",{rows:5,...h("objective",{required:"* Tidak boleh kosong"}),className:"textarea textarea-primary"}),p.objective&&(0,s.jsx)("label",{className:"label",children:(0,s.jsx)("span",{className:"label-text-alt text-error",children:p.objective.message})})]}),(0,s.jsxs)("div",{className:"form-control",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Assesment"})}),(0,s.jsx)("textarea",{rows:5,...h("assesment",{required:"* Tidak boleh kosong"}),className:"textarea textarea-primary"}),p.assesment&&(0,s.jsx)("label",{className:"label",children:(0,s.jsx)("span",{className:"label-text-alt text-error",children:p.assesment.message})})]}),(0,s.jsxs)("div",{className:"form-control",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Plan"})}),(0,s.jsx)("textarea",{rows:5,...h("plan",{required:"* Tidak boleh kosong"}),className:"textarea textarea-primary"}),p.plan&&(0,s.jsx)("label",{className:"label",children:(0,s.jsx)("span",{className:"label-text-alt text-error",children:p.plan.message})})]}),(0,s.jsxs)("div",{className:"form-control",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Instruksi"})}),(0,s.jsx)("textarea",{rows:5,...h("instruksi",{required:"* Tidak boleh kosong"}),className:"textarea textarea-primary"}),p.instruksi&&(0,s.jsx)("label",{className:"label",children:(0,s.jsx)("span",{className:"label-text-alt text-error",children:p.instruksi.message})})]})]}),(null==t?void 0:t.user.role)==="dokter"&&(0,s.jsxs)("div",{className:"flex flex-col w-full items-center gap-2 p-3",children:[(0,s.jsxs)("div",{className:"form-control w-full px-6 mb-6",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text",children:"Kode Diagnosa"})}),(0,s.jsx)(c.Z,{className:"select-info w-full",isClearable:!0,name:"icdx",loadOptions:e=>new Promise(a=>{a(B(e))}),defaultOptions:!0,onChange:e=>z(e),placeholder:"Cari Diagnosa",instanceId:m})]}),(0,s.jsxs)("div",{className:"flex w-full p-3 gap-2",children:[(0,s.jsxs)("div",{className:"form-control w-1/2 border-2 p-2",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text text-lg font-bold ",children:"Resep"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(c.Z,{className:"select-info w-full",isClearable:!0,name:"obat",loadOptions:e=>new Promise(a=>{a(q(e))}),defaultOptions:!0,onChange:e=>V(e),placeholder:"Cari obat",instanceId:m}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)("input",{type:"number",onChange:e=>y(e.target.value),value:w,placeholder:"Jumlah",className:"input input-sm input-primary w-1/3"}),(0,s.jsx)("input",{type:"text",onChange:e=>C(e.target.value),value:S,placeholder:"Signa 1",className:"input input-sm input-primary w-1/3"}),"X",(0,s.jsx)("input",{type:"text",onChange:e=>Z(e.target.value),value:O,placeholder:"Signa 2",className:"input input-sm input-primary w-1/3"})]}),(0,s.jsxs)("select",{className:"select select-primary w-full select-sm",onChange:e=>P(e.target.value),value:_,children:[(0,s.jsx)("option",{value:"",children:"Silahkan Pilih"}),(0,s.jsx)("option",{value:"Sebelum Makan",children:"Sebelum Makan"}),(0,s.jsx)("option",{value:"Sesudah Makan",children:"Sesudah Makan"})]}),(0,s.jsxs)("select",{className:"select select-primary w-full select-sm",onChange:e=>D(e.target.value),value:I,children:[(0,s.jsx)("option",{value:"",children:"Silahkan Pilih"}),(0,s.jsx)("option",{value:"Pagi",children:"Pagi"}),(0,s.jsx)("option",{value:"Siang",children:"Siang"}),(0,s.jsx)("option",{value:"Malam",children:"Malam"})]}),(0,s.jsx)("textarea",{onChange:e=>T(e.target.value),placeholder:"Catatan",className:"textarea textarea-primary",value:R}),(0,s.jsx)("button",{onClick:()=>E(),className:"btn btn-sm btn-warning",type:"button",disabled:""===_||""===I,children:"Tambah"})]})]}),(0,s.jsxs)("div",{className:"w-1/2 flex flex-col gap-2 border-2 p-2",children:[(0,s.jsx)("div",{className:"label",children:(0,s.jsx)("span",{className:"label-text font-bold text-lg",children:"List Resep"})}),f.map((e,a)=>(0,s.jsxs)("div",{className:"bg-base-300 p-2 rounded flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"italic flex flex-col",children:[(0,s.jsx)("p",{className:"font-medium",children:"R/"}),(0,s.jsxs)("p",{className:"font-medium",children:[e.namaObat," (",e.signa1,"X",e.signa2,")"]}),(0,s.jsx)("p",{children:e.aturanPakai}),(0,s.jsx)("p",{children:e.waktu}),(0,s.jsx)("p",{children:e.catatan})]}),(0,s.jsx)("button",{type:"button",onClick:()=>L(a),className:"btn btn-error btn-circle btn-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z",clipRule:"evenodd"})})})]},e.obatId))]})]})]}),(null==t?void 0:t.user.role)==="dokter"||(null==t?void 0:t.user.role)==="perawat"?(0,s.jsx)(l.v,{}):(0,s.jsx)(o,{message:"Anda bukan perawat / dokter!"})]})}},1317:function(e,a,t){"use strict";t.d(a,{P:function(){return s},n:function(){return l}});let s=async e=>{let{url:a}=e;try{let e=await fetch("".concat("http://localhost:8001/api","/").concat(a),{headers:{"Content-Type":"application/json",Authorization:"".concat("IDsM4RtcaR32024*@>")}});if(!e.ok)return console.error("Error: ".concat(e.status," - ").concat(e.statusText)),null;return await e.json()}catch(e){return console.error("Failed to fetch data:",e),null}},l=async e=>{let{url:a,data:t}=e;try{let e=await fetch("".concat("http://localhost:8001/api","/").concat(a),{headers:{"Content-Type":"application/json",Authorization:"".concat("IDsM4RtcaR32024*@>")},method:"POST",body:JSON.stringify(t)});return await e.json()}catch(e){return null}}}},function(e){e.O(0,[9461,9343,5151,2971,7023,1744],function(){return e(e.s=5986)}),_N_E=e.O()}]);