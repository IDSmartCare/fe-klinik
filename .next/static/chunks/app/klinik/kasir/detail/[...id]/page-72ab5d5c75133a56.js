(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9684],{2480:function(){},765:function(e,t,r){Promise.resolve().then(r.bind(r,77))},6463:function(e,t,r){"use strict";var n=r(1169);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},5162:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});var n=r(4379),i=r.n(n);function s(e){let{icon:t,title:r}=e;i().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=i().stopTimer,e.onmouseleave=i().resumeTimer}}).fire({icon:t,title:r})}},77:function(e,t,r){"use strict";r.d(t,{default:function(){return d}});var n=r(7437),i=r(2265),s=r(5162);r(4590);var l=(0,r(8064).$)("05de4135ada0749cb62c9b8dee723283365060fe"),a=r(5100);let o=(0,r(7818).default)(()=>Promise.resolve().then(r.bind(r,5100)).then(e=>e.PDFViewer),{loadableGenerated:{webpack:()=>[null]},ssr:!1,loading:()=>(0,n.jsx)("p",{children:"Loading..."})});var c=e=>{let{tagihan:t}=e,r=null==t?void 0:t.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0),i=a.StyleSheet.create({page:{padding:30},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},companyInfo:{width:"40%"},customerInfo:{textAlign:"right",width:"60%"},logo:{width:100,height:100},title:{fontSize:24,marginBottom:10,textAlign:"center"},item:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#ddd",marginBottom:5,paddingBottom:5},itemName:{width:"70%"},itemPrice:{textAlign:"right",width:"30%"},total:{textAlign:"right",fontSize:18,marginTop:20}});return(0,n.jsx)("dialog",{id:"modal-print-bill-pasien",className:"modal",children:(0,n.jsxs)("div",{className:"modal-box w-8/12 max-w-2xl",children:[(0,n.jsx)("form",{method:"dialog",children:(0,n.jsx)("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"âœ•"})}),(0,n.jsx)(o,{className:"w-full h-80",children:(0,n.jsx)(a.Document,{children:(0,n.jsxs)(a.Page,{style:i.page,children:[(0,n.jsx)(a.View,{style:i.header}),(0,n.jsx)(a.Text,{style:i.title,children:"Invoice Pasien"}),(0,n.jsxs)(a.View,{style:i.item,children:[(0,n.jsx)(a.Text,{style:i.itemName,children:"Item"}),(0,n.jsx)(a.Text,{style:i.itemPrice,children:"Sub Total"})]}),null==t?void 0:t.billPasienDetail.map(e=>(0,n.jsxs)(a.View,{style:i.item,children:[(0,n.jsxs)(a.Text,{style:i.itemName,children:[e.deskripsi," ",e.jumlah,"@",e.harga]}),(0,n.jsx)(a.Text,{style:i.itemPrice,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.subTotal))})]},e.id)),(0,n.jsxs)(a.Text,{style:i.total,children:["Total: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(r))]}),null==t?void 0:t.pembayaranBill.map(e=>(0,n.jsxs)(a.View,{children:[(0,n.jsxs)(a.Text,{style:i.total,children:["Diskon: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.totalDiskon))]}),(0,n.jsxs)(a.Text,{style:i.total,children:["Pajak: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.totalPajak))]}),(0,n.jsxs)(a.Text,{style:i.total,children:["Total Bayar: ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.totalBayar))]}),(0,n.jsxs)(a.Text,{style:i.total,children:["Kembalian : ",new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.kembalian))]})]},e.id)),(0,n.jsxs)(a.Text,{style:i.total,children:["Status: ",null==t?void 0:t.status]})]})})})]})})},u=r(6463),d=e=>{let{detailBill:t}=e,[r,a]=(0,i.useState)(""),[o,d]=(0,i.useState)(""),[m,h]=(0,i.useState)(0),[b,x]=(0,i.useState)(0),[f,y]=(0,i.useState)(0),[j,p]=(0,i.useState)(0),[N,g]=(0,i.useState)(0),[I,w]=(0,i.useState)(0),[v,D]=(0,i.useState)(),S=(0,u.useRouter)();(0,i.useEffect)(()=>{x(null==t?void 0:t.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0)),h(null==t?void 0:t.billPasienDetail.reduce((e,t)=>Number(e)+Number(t.subTotal),0))},[t]);let T=e=>{a(e),k(Number(e),Number(o))},P=e=>{d(e),k(Number(r),Number(e))},k=(e,t)=>{let r=e/100*b;g(r);let n=b-r,i=t/100*n;w(i),h(n+i)},R=e=>{0===Number(e)?y(0):(p(Number(e)),y(Number(e)-m))},B=async()=>{if(0===j)(0,s.o)({icon:"error",title:"Pembayaran harus diisi!"});else if(j<m)(0,s.o)({icon:"error",title:"Pembayaran harus lebih besar/sama dengan total tagihan!"});else{let e={id:t.id,pendaftaranId:t.pendaftaranId,bayar:j,total:m,totalDiskon:N,totalPajak:I,kembali:f,tglBayar:new Date};try{if(!(await fetch("/api/kasir/bayar",{method:"POST",body:JSON.stringify(e)})).ok){(0,s.o)({icon:"error",title:"Gagal simpan data!"});return}(0,s.o)({icon:"success",title:"Berhasil!"}),S.refresh()}catch(e){console.log(e),(0,s.o)({icon:"error",title:e.message})}}},A=async e=>{let t=await l(e);if(t.status){var r;D(t.data),await new Promise(e=>setTimeout(e,2e3)),(null===(r=document)||void 0===r?void 0:r.getElementById("modal-print-bill-pasien")).showModal()}else(0,s.o)({icon:"error",title:t.message})};return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"table table-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{}),(0,n.jsx)("th",{children:"Deskripsi"}),(0,n.jsx)("th",{children:"Jumlah"}),(0,n.jsx)("th",{children:"Harga"}),(0,n.jsx)("th",{children:"Total"})]})}),(0,n.jsxs)("tbody",{children:[t.billPasienDetail.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:t+1}),(0,n.jsx)("td",{children:e.deskripsi}),(0,n.jsx)("td",{children:e.jumlah}),(0,n.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.harga))}),(0,n.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(e.subTotal))})]},e.id)),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Sub Total"}),(0,n.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(b)})]}),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Diskon %"}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"number",value:r,onChange:e=>T(e.target.value),className:"input input-sm input-primary"})})]}),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Pajak %"}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"number",onChange:e=>P(e.target.value),value:o,className:"input input-sm input-primary"})})]}),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Total"}),(0,n.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(m)})]}),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Jumlah Pembayaran"}),(0,n.jsx)("td",{children:(0,n.jsx)("input",{type:"number",onChange:e=>R(e.target.value),className:"input input-sm input-primary"})})]}),(0,n.jsxs)("tr",{className:"font-semibold",children:[(0,n.jsx)("td",{colSpan:4,className:"text-right",children:"Kembali"}),(0,n.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(f)})]}),(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,children:"LUNAS"===t.status?(0,n.jsxs)("div",{className:"flex flex-col gap-3 mt-5",children:[(0,n.jsx)("button",{className:"btn btn-success btn-sm",children:"LUNAS"}),(0,n.jsx)("button",{className:"btn btn-info btn-sm",onClick:()=>A(t.id),children:"CETAK KWITANSI"})]}):(0,n.jsx)("button",{onClick:()=>B(),className:"btn btn-primary btn-sm btn-block",children:"BAYAR"})})})]})]})}),(0,n.jsx)(c,{tagihan:v})]})}},8362:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},2988:function(e,t,r){"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}r.d(t,{Z:function(){return n}})},3950:function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}r.d(t,{Z:function(){return n}})},8620:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,{Z:function(){return n}})},5352:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(8362);function i(e,t){if(e){if("string"==typeof e)return(0,n.Z)(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}}},function(e){e.O(0,[9461,249,7448,7282,2353,2971,7023,1744],function(){return e(e.s=765)}),_N_E=e.O()}]);